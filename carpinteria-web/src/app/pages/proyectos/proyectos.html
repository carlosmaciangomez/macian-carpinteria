<div class="proyectos-page">

    <header class="header">
        <h1>Proyectos</h1>
        <p>Nuestros trabajos realizados. Filtra por tipo si quieres ver algo concreto.</p>
    </header>

    <!-- Filtros fijos arriba -->
    <div class="filtros-wrapper">
        <div class="filtros">
            <button (click)="setTipo(null)" [class.filtro-activo]="!tipoActivo">
                Todos
            </button>

            @for (tipo of tipos; track $index) {
            <button (click)="setTipo(tipo)" [class.filtro-activo]="tipoActivo === tipo">
                {{ tipo | titlecase }}
            </button>
            }
        </div>
    </div>

    <!-- Lista (en móvil: columna) -->
    <section class="grid">
        @for (p of proyectosFiltrados; track $index) {
        <article class="card">

            @if (portadaEsVideo(p)) {
            <video class="portada" [src]="getPortada(p)" muted controls></video>
            } @else {
            <img class="portada" [src]="getPortada(p)" alt="Proyecto" />
            }

            <div class="card-body">
                <h3>{{ p.title }}</h3>
                <p>{{ p.description }}</p>
                <div class="meta">
                    <span class="tipo">{{ p.tags[0] | titlecase }}</span>
                    <span class="fecha">
                        {{ p.createdAt?.toDate() | date:'shortDate' }}
                    </span>
                </div>
            </div>

        </article>
        } @empty {
        <p class="empty">No hay proyectos publicados todavía.</p>
        }
    </section>

</div>